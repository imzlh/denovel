<h1 style="font-size: 5rem"> denovel </h1>

> [!TIP]
> denovel发展了半年，理论上比较完善了<br>
> 如果有bug，欢迎issue，但是苦逼的我可能只有周末有空

# 入手初体验

> [!TIP]
> denovel 二进制比较大，因为功能错杂，使用了大量库。<br>
> 如果你觉得太慢了，可以去Artifacts下载压缩的实时版本<br>
> 别忘记解压和重命名为 `denovel.exe` !

从右侧release下载适用于你平台的denovel，打开文件位置，右键打开终端，使用 `denovel [命令]`

当然，对于小白，我们提供了更简单的方法。双击打开就行了，会显示
```
densh # 
```
此时就可以直接键入命令。输入 `help` 看看可用的命令

# 下载小说
下载小说是denovel的核心功能之一，当然，之二是小说处理

**注意** 有部分网站有CC保护，请合理安排间隔时间 "-s"

## 终端

**如果你是小白，建议从服务模式开始入手**

虽然操作略繁琐一些，但是提供的功能更多，更友好一些，但是是单任务的


```sh
    denovel downovel <url> -s 5 -l -e
```
强烈建议：搭配以下flag使用:
 - `-e` 输出epub
 - `-s` 请求间隔时间，重试不受影响
 - `-p` 有些奇葩的网站内容自带章节标题且内容零散，指定可以避免程序自动添加网页给的标题<br>
    再简单点就是网页上的章节标题没有任何作用，指定让denovel忽略它
 - `-l` 基于词典的繁体中文转简体中文。虽然不完美，但是只需要一个flag就可用的还不满意吗？

## 网页端
```sh
    denovel server
```
打开"127.0.0.1:8000"即可。

> [!IMPORTANT]
> 某些情况下（如需要登录、验证码等）可能会出现卡住不动的情况，建议检查一下终端<br>
> 因此建议在本机运行服务，或提前配置好账号，以下可能有验证:
>  - uaa
>  - 起点

### 进阶： 内容服务API
![API](image-2.png)
通过在网页前加上 `你的服务器IP:8000/content?url=`，即可享受<br>
或者打开`你的IP:8000/content`，在输入框内容输入<br>
或者在主页面直接点击"预览"按钮，效果一致

如果想要输出JSON，加上`json`即可，如`/content?json&url=...`

### 进阶用法：浏览器扩展
请确保你安装了 油猴（又称 篡改猴）<br>
打开：
https://greasyfork.org/zh-CN/scripts/546122-bing%E5%B0%8F%E8%AF%B4%E8%87%AA%E5%8A%A8%E4%B8%8B%E8%BD%BD%E5%8A%A9%E6%89%8B
安装即可

安装后，请使用bing搜索，建议搜索时添加“小说”关键词，当然脚本也会自动判断为你省力<br>
当出现“配置不完整”时，请点击链接，复制第一章链接和其余信息，手动下载<br>
看到“可下载”后点击按钮，出现成功弹窗后打开控制台，点击“刷新队列”即可
![自动下载](image-1.png)

# 小说相关

## 转换epub(支持传入文件夹批量转换)
```sh
    denovel 2epub.ts <文件(夹)>
```
支持批量，自动寻找标题将txt转换为epub，同时缓存图片资源<br>
txt支持许多格式，冷门的热门的标题方案都有兼容（太牵强的没有）<br>
目前成功率99.9%，但是有误判的可能，使用 `2txt.ts` 可以反过程

## 蓝奏云下载器
下载无需密码的部分（支持文件夹递归，使用eval获取100%的兼容性）<br>
暂时用不到密码解锁，有需要欢迎issue

> [!IMPORTANT]
> 蓝奏有严格的时间间隔检查，否则会400(坑死我了)。<br>
> 源码已经实现8x并行下载，且已经调优到最短的时间间隔，因此千万不要改源代码

```sh
    denovel lanzou
```

## 夸克下载器
alist的 挂载 + 拷贝 非常难用且容易出问题<br>
Cookie的获取参考OpenList文档，实用度比较高

> ![IMPORTANT]
> 这个脚本没有破解限速，也存在Cookie存活时长的问题<br>
> 不适用于下载大文件，下载1w个txt小说也就差不多了

## 蓝奏云小说名修复
垃圾蓝奏云，总是会和谐掉小说名中的一些内容，导致非常难以管理<br>
`fixname` 提供了简单的小工具，提取类似
```
...
综漫：诸天万界从恶魔咒蓝开始
作者：白白白粥

书籍简介：...
```
的格式

# 杂项

## 下载漫画
与小说下载相似，使用相同的命令格式（但不一定有用）<br>
下载漫画更复杂，需要处理HTTP源等，因此每个文件都是不同的实现方法<br>
相似的，使用命令处理，支持断点。输出的zComicLib文件(<小说名>.<网站>.txt)可以传递给文件作为参数继续下载

```sh
    denovel downcomic <可选，缓存文件> -f png
```

输出长图png(支持epub/png/cbz)，通过`-f`指定

> [!TIP]
> 如果下载的是条漫（长条式），建议使用长图png <br>
> 其他情况，使用epub/cbz更好

# m3u8万能工具
如果你遇到过 m3u8+png图床 的奇葩配方，无法被ffmpeg识别下载，那你找对地方了<br>
使用`specialm3u8.ts` + `ffmpeg` 组合拳，打遍天下无敌手~
```sh
denovel m3u8 "<m3u8网址>"
ffmpeg -i "http://localhost:12345/index.m3u8" -c:a copy -c:v copy 名称.mp4
```

## 繁体批量转换
```sh
denovel t2cn "<文件/文件夹>"
```
一样是基于词典的，这里不多做描述

## 回转txt

如果你有一堆 `epub/docx/pdf` (仅限于内嵌文本而不是图片)的小说，2epub绝对能满足你。
```sh
denovel 2txt "<文件/文件夹>"
```
一样支持批量，输出到文件夹中，当然也包括资源文件(epub已测试，其他格式也许兼容性不佳)。

如果你转txt的目的是生成epub，完全可以使用`-e`参数。使用`-k`可以阻止生成成功后自动删除txt

如果只是为了生成txt供mp4使用，可以使用`-i`忽略资源文件节省时间

> [!TIP]
> 默认出现生成epub错误时程序会退出。如果你不介意批量中出现部分生成错误，使用`-f`可以让程序继续执行，忽略错误

> [!IMPORTANT]
> 如果不是为了`epub`转`epub`，即目的不是原epub的分章不合理，单纯想生成txt<br>
> 对于非本程序生成的epub，请务必加上`-t`或`--add-title`。默认会删除所有页面标题，这不利于mp4等设备的分章程序正常运行

## 高级拷贝
```ts
denovel copy "<from>" "<to>" ...
```

## 高级文件转换(基于ffmpeg)
确保安装了ffmpeg
TODO

## 关键词批量查找
TODO

## 网易云音乐下载
TODO

## txt分堆
这个对于大量txt来说特别有用。

mp4等设备屏幕太小，找txt很麻烦怎么办？使用这个程序分堆，方便寻找
```sh
denovel part "<文件夹>"
```

# 还有的文件都是用来干什么的？
都是平时爬虫攒的小东西，留作备份便与下次改一改使用

如果你仔细看注释，也许能发现妙用，但是这里不说了，只局限于某些网站